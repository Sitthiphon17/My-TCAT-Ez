<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TCAS Planner — ภาค/มหาวิทยาลัย • ตารางอ่าน • ข้อสอบ • แฟลชการ์ด • ชุมชน</title>
  <meta name="description" content="เว็บช่วยวางแผน TCAS: เลือกภาค-มหาวิทยาลัย-คณะ, รอบรับสมัคร, สร้างตารางอ่าน, ทำข้อสอบ TGAT/TPAT, แฟลชการ์ด, กระดานชุมชน, แจ้งเตือน"/>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1/plugin/customParseFormat.js"></script>
  <script>dayjs.extend(dayjs_plugin_customParseFormat);</script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap');
    body { font-family: 'Sarabun', system-ui, -apple-system, sans-serif; }
    .pill { @apply px-3 py-1 rounded-full text-sm border; }
    .hidden { display:none; }
    .spark { transition: filter 0.4s ease; }
    .spark.off { filter: grayscale(1) brightness(0.75); }
  </style>
</head>
<body class="min-h-screen bg-slate-50 text-slate-900">
  <header class="sticky top-0 z-40 backdrop-blur bg-white/85 border-b">
    <div class="max-w-7xl mx-auto px-4 py-3 flex items-center gap-3">
      <div class="w-9 h-9 rounded-xl bg-indigo-600 text-white grid place-items-center font-bold">TC</div>
      <h1 class="text-lg font-bold">TCAS Planner</h1>
      <nav class="ml-auto flex gap-1">
        <button data-tab="home" class="tab-btn pill">ภาค/มหาวิทยาลัย</button>
        <button data-tab="schedule" class="tab-btn pill">ตารางอ่าน (ไฟไม่ดับ)</button>
        <button data-tab="exam" class="tab-btn pill">ข้อสอบ & Mock Test</button>
        <button data-tab="flashcards" class="tab-btn pill">แฟลชการ์ด</button>
        <button data-tab="progress" class="tab-btn pill">ความคืบหน้า</button>
        <button data-tab="community" class="tab-btn pill">ชุมชน</button>
        <button data-tab="settings" class="tab-btn pill">ตั้งค่า</button>
      </nav>
    </div>
  </header>

  <main class="max-w-7xl mx-auto p-4 grid gap-6">
    <section id="tab-home" class="grid lg:grid-cols-3 gap-6">
      <div class="lg:col-span-1 border rounded-2xl p-5 bg-white">
        <h2 class="text-xl font-semibold">เลือกภาค</h2>
        <p class="text-sm text-slate-600 mb-3">เลือกภาคเพื่อดูมหาวิทยาลัย/คณะที่เปิดรับ</p>
        <select id="regionSelect" class="w-full border rounded-xl p-2"></select>
        <div class="mt-4">
          <label class="text-sm font-medium">หรือค้นหา</label>
          <input id="searchInput" class="mt-1 w-full border rounded-xl p-2" placeholder="เช่น สงขลานครินทร์, แพทย์, วิศวะ, รอบ 1"/>
          <div class="mt-2 flex flex-wrap gap-2">
            <button class="filter-chip pill" data-filter="รอบ 1">รอบ 1</button>
            <button class="filter-chip pill" data-filter="รอบ 2">รอบ 2</button>
            <button class="filter-chip pill" data-filter="รอบ 3">รอบ 3</button>
            <button class="filter-chip pill" data-filter="รอบ 4">รอบ 4</button>
            <button class="filter-chip pill" data-filter="TGAT">TGAT</button>
            <button class="filter-chip pill" data-filter="TPAT">TPAT</button>
          </div>
        </div>
      </div>
      <div class="lg:col-span-2 border rounded-2xl p-5 bg-white">
        <div class="flex items-center justify-between gap-2 mb-3">
          <h2 class="text-xl font-semibold">มหาวิทยาลัย / คณะ / สาขา</h2>
          <span id="resultCount" class="text-sm text-slate-600"></span>
        </div>
        <div id="uniList" class="grid gap-3"></div>
      </div>
    </section>

    <section id="tab-schedule" class="hidden grid lg:grid-cols-3 gap-6">
      <div class="lg:col-span-1 border rounded-2xl p-5 bg-white">
        <h2 class="text-xl font-semibold">สร้างตารางอ่าน</h2>
        <label class="text-sm mt-2 block">เลือกคณะ/สาขาเป้าหมาย</label>
        <select id="targetProgram" class="w-full border rounded-xl p-2 mb-2"></select>
        <label class="text-sm block">กำหนดวันสอบ (โดยประมาณ)</label>
        <input id="examDate" type="date" class="w-full border rounded-xl p-2 mb-2"/>
        <label class="text-sm block">ชั่วโมงอ่าน/วัน</label>
        <input id="hoursPerDay" type="number" value="2" min="1" max="12" class="w-full border rounded-xl p-2 mb-2"/>
        <button id="buildPlan" class="w-full bg-indigo-600 text-white rounded-xl py-2 font-medium">สร้างแผน</button>

        <div class="mt-4 flex items-center gap-3">
          <img id="sparkIcon" src="assets/spark.svg" class="w-10 h-10 spark" alt="ไฟสถานะ"/>
          <div>
            <div class="font-semibold">ไฟไม่ดับ</div>
            <div class="text-xs text-slate-600">ทำภารกิจประจำวันให้ครบ ไฟจะสว่าง</div>
          </div>
        </div>
      </div>
      <div class="lg:col-span-2 border rounded-2xl p-5 bg-white">
        <h2 class="text-xl font-semibold">ภารกิจวันนี้</h2>
        <ul id="todayTasks" class="list-disc pl-5 space-y-2"></ul>
        <button id="completeDay" class="mt-3 bg-emerald-600 text-white rounded-xl px-4 py-2">ทำภารกิจวันนี้เสร็จ</button>
        <div class="mt-6">
          <h3 class="font-semibold mb-2">ตารางทั้งหมด</h3>
          <div id="planTable" class="overflow-x-auto">
            <table class="min-w-full text-sm">
              <thead><tr class="text-left">
                <th class="p-2">วันที่</th><th class="p-2">หัวข้อ</th><th class="p-2">ชั่วโมง</th><th class="p-2">สถานะ</th>
              </tr></thead>
              <tbody id="planBody"></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <section id="tab-exam" class="hidden grid lg:grid-cols-3 gap-6">
      <div class="lg:col-span-1 border rounded-2xl p-5 bg-white">
        <h2 class="text-xl font-semibold">เลือกชุดข้อสอบ</h2>
        <label class="text-sm block">หมวด</label>
        <select id="examCategory" class="w-full border rounded-xl p-2 mb-2"></select>
        <label class="text-sm block">จำนวนข้อ</label>
        <input id="examCount" type="number" min="5" max="30" value="10" class="w-full border rounded-xl p-2 mb-2"/>
        <button id="startExam" class="w-full bg-indigo-600 text-white rounded-xl py-2">เริ่มทำ</button>
      </div>
      <div class="lg:col-span-2 border rounded-2xl p-5 bg-white">
        <div id="examBox" class="space-y-3">
          <h2 class="text-xl font-semibold">Mock Test</h2>
          <div id="examMeta" class="text-sm text-slate-600"></div>
          <div id="questionArea"></div>
          <div class="flex gap-2">
            <button id="prevQ" class="pill">ก่อนหน้า</button>
            <button id="nextQ" class="pill">ถัดไป</button>
            <button id="submitExam" class="ml-auto bg-emerald-600 text-white rounded-xl px-4 py-2">ส่งคำตอบ</button>
          </div>
          <div id="examResult" class="hidden"></div>
        </div>
      </div>
    </section>

    <section id="tab-flashcards" class="hidden grid lg:grid-cols-3 gap-6">
      <div class="lg:col-span-1 border rounded-2xl p-5 bg-white">
        <h2 class="text-xl font-semibold">แฟลชการ์ด</h2>
        <label class="text-sm block">เลือกชุด</label>
        <select id="flashCategory" class="w-full border rounded-xl p-2 mb-2"></select>
        <button id="startFlash" class="w-full bg-indigo-600 text-white rounded-xl py-2">เริ่มทบทวน</button>
      </div>
      <div class="lg:col-span-2 border rounded-2xl p-5 bg-white">
        <div id="flashArea" class="text-center">
          <div id="flashCard" class="hidden">
            <div id="flashFront" class="text-lg font-semibold mb-3"></div>
            <button id="showBack" class="pill">ดูคำตอบ</button>
            <div id="flashBack" class="hidden mt-3 text-slate-700"></div>
            <div class="mt-4 flex justify-center gap-2">
              <button class="flashGrade pill" data-grade="again">Again</button>
              <button class="flashGrade pill" data-grade="good">Good</button>
              <button class="flashGrade pill" data-grade="easy">Easy</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="tab-progress" class="hidden border rounded-2xl p-5 bg-white">
      <h2 class="text-xl font-semibold mb-2">ความคืบหน้า</h2>
      <div class="grid md:grid-cols-2 gap-6">
        <div class="border rounded-2xl p-4">
          <h3 class="font-semibold mb-2">กราฟการทำข้อสอบ</h3>
          <canvas id="examChart" width="400" height="240"></canvas>
        </div>
        <div class="border rounded-2xl p-4">
          <h3 class="font-semibold mb-2">สรุปตารางอ่าน</h3>
          <div id="progressSummary" class="text-sm text-slate-700"></div>
        </div>
      </div>
    </section>

    <section id="tab-community" class="hidden grid lg:grid-cols-3 gap-6">
      <div class="lg:col-span-1 border rounded-2xl p-5 bg-white">
        <h2 class="text-xl font-semibold">กระดานชุมชน</h2>
        <input id="postTitle" class="w-full border rounded-xl p-2 mb-2" placeholder="หัวข้อโพสต์"/>
        <textarea id="postBody" class="w-full border rounded-xl p-2 mb-2" rows="4" placeholder="แชร์เคล็ดลับ/คำถาม/ทรัพยากร"></textarea>
        <button id="createPost" class="w-full bg-indigo-600 text-white rounded-xl py-2">โพสต์</button>
      </div>
      <div class="lg:col-span-2 border rounded-2xl p-5 bg-white">
        <h3 class="font-semibold mb-2">โพสต์ล่าสุด</h3>
        <div id="postList" class="grid gap-3"></div>
      </div>
    </section>

    <section id="tab-settings" class="hidden border rounded-2xl p-5 bg-white">
      <h2 class="text-xl font-semibold">ตั้งค่า & เคล็ดลับ</h2>
      <div class="grid md:grid-cols-2 gap-6">
        <div class="border rounded-2xl p-4">
          <h3 class="font-semibold mb-2">การแจ้งเตือน</h3>
          <button id="enableNoti" class="pill">เปิดการแจ้งเตือน</button>
          <p class="text-sm text-slate-600 mt-2">จะเตือนเวลาเริ่มอ่าน/เดดไลน์รับสมัคร</p>
        </div>
        <div class="border rounded-2xl p-4">
          <h3 class="font-semibold mb-2">เคล็ดลับทำข้อสอบ</h3>
          <ul class="list-disc pl-5 text-sm" id="tipsList"></ul>
        </div>
      </div>
    </section>
  </main>

  <footer class="max-w-7xl mx-auto p-6 text-center text-xs text-slate-500">
    สตาร์ทเตอร์นี้ใช้ข้อมูล TCAS69 เบื้องต้น ปรับตามประกาศคณะจริงได้ใน <code>/data</code>
  </footer>

  <script src="data/tcas-data.js"></script>
  <script src="components/ui.js"></script>
  <script src="components/exam.js"></script>
  <script src="components/flashcards.js"></script>
  <script src="services/schedule.js"></script>
  <script src="services/progress.js"></script>
  <script src="services/notifications.js"></script>
  <script src="services/tips.js"></script>
</body>
</html>
